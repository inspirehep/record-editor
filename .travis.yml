notifications:
  email: false
language: node_js

node_js:
  - 6.9.1
  - node

sudo: false
dist: trusty

before_script:
  - npm run lint
  - npm run build

before_install:
  - npm install buffer-shims
  - export CHROME_BIN=chromium-browser
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start
  - npm install

before_deploy:
  - node ./write-version.js
  - npm run build

after_success: npm run coveralls

deploy:
  - provider: script
    skip_cleanup: true
    script: cd $TRAVIS_BUILD_DIR; ./build-and-deploy.sh
    on:
      branch: master

env:
  global:
  # DOCKERHUB_USER
  - secure: mN3WSX1M7gLg140H0fwg3LjSAS8jtcAm8gLUcPc65BBO/BFnD1g6JNSFo4SMXTJpX2z0Bx5tNd+rKfqkQXjhfRXmS0RZwNyUgx/EtcQ38CH8sZa0+HKinwZu5O88ktHJ8avOJ/ebSKRAUgyXAmU6wNoTHT5f8OCkDi3dtWIYGFKAQfq9EjtfWV8h4cY3OOYqAdbpJNhUzkHgQ/WiNuFxghAcku6t3QztqsSTP0Q9xYIFx03gZgSztnDoQZfgxVpwj5gIsK9heu6EcJh5S9dYSsyoeqoT7vEZujLxF1g3t1G5bREcCCsLYxYdmsTrgDm3cexWxHxERH2i40YsT7DVuKL4yvWT55nkNJlkqMwWCGJSrdoxqb6c750yW4t/lvU3HVjxS2MI7oS1sPlSB3KVyvd5A0+G/yykJRZocJo0iyZ+WvbNuz6/9Q9wGJH7IgXJjarZgwPAblUZ991MUVO8O/zSMCpNg3VK49FHLwYoAIJGW4IPL25XDQuI+3ObWVpBzUg43J46Cij3ZEDXmVCvRd8lpiBoU7NGZkGE18Bxrl5yvaQJssM8KvBuBNDi005FT+5esPd+yJQSXdf5pXyxMlOhO0eYCkf9XX6DDh/U6DgTT73XK7TU7T5SH9LS2PDS6qL8Exry0UpY3sTjkcxDO1cDO3+ivkO2v/TIy15Avp4=
  # DOCKERHUB_PASSWORD
  - secure: DzyMXU4E26NlSVVwe2oC2NMOi9Pe0rIDnQKAwPQFX3xOXLqJNpj++RYpc2y1xeXQP1DgDSYT/zWx/DN/hqp8Wcg19ky/7knVaheyJG1aw35d0j4ls0mikt1M9ipFab/vx/uCUvie/M14FA/2YI654ZcZa332CGXfosqUKFL+EFoCupRPvSb0PhZ80vPx1liTaj3NhrMTcSin0C+vlNCI+oj2nWdrRo5rduLEu3NbBmX7O5YyslR5c+IYyFREioH3/HzT1DZL28I3ad8nWidqYIG09tHVNDRI4aoO6ykZrygZ7ciAAsCZOEpQJZbBKZTCpo6Voewm4r0MpCOODcK717hW025YaBJcOJ1Qm7rluCLbgHmzHC8hiZSSnFodpaDW4JlfpSS0PWkCzJ0cXN2DzGfmZlD/s9gzr/t0/XL1WWHKf/wDUFtFXIwFfyLlcdMKAuBr1cpC6l3nVmyaaBY2jazpOQpBoGcilvrJpweuncRs3ZufCGL/79w3Tx3v/3RjwebKMwCJNx8Kz1kuSOn6fSizt4+XdsKJUmkNNbmWn1162jk+FolHEGMjPqV6XEkcJBOiZreKEtxTQB0pARBZKz8zsXs/4LyiapitiwLxs/kj/VW3KPYeHClDC4zrDp4bqw7VLuMQEdqbDINL04ec8khsNpkFDCdZmQy/y9/hKJM=
